!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){var e={options:{optionClass:"",dropdownClass:"",autoinit:!1,callback:!1,onSelected:!1,dynamicOptLabel:"Add a new option..."},init:function(o){function n(n){if(!n.data("dropdownjs")&&n.is("select")){var a=n.attr("multiple"),d=n.attr("data-dynamic-opts"),i=t(),s=t("<div></div>");s.addClass("dropdownjs").addClass(o.dropdownClass),s.data("select",n);var l=t("<input type=text readonly class=fakeinput>");t.material&&l.data("mdproc",!0),s.append(l);var r=t("<ul></ul>");r.data("select",n),s.append(r),l.attr("placeholder",n.attr("placeholder")),n.find("option").each(function(){var o=t(this);e._addOption(r,o)}),d&&(i=t("<li class=dropdownjs-add></li>"),i.append("<input>"),i.find("input").attr("placeholder",o.dynamicOptLabel),r.append(i));s.find("li");if(a){var c=[],p=n.val();for(var f in p)c.push("li[value="+p[f]+"]");c.length>0&&e._select(s,s.find(c.join(",")))}else{var u;u=n.find(":selected").length?n.find(":selected").last():n.find("option, li").first(),e._select(s,u)}l.addClass(n[0].className),n.hide().attr("data-dropdownjs",!0),n.after(s),o.callback&&o.callback(s),r.on("click","li:not(.dropdownjs-add)",function(o){e._select(s,t(this)),n.change()}),r.on("keydown","li:not(.dropdownjs-add)",function(o){return 27===o.which?(t(".dropdownjs > ul > li").attr("tabindex",-1),l.removeClass("focus").blur()):32!==o.which||t(o.target).is("input")?void 0:(e._select(s,t(this)),!1)}),r.on("focus","li:not(.dropdownjs-add)",function(){n.is(":disabled")||l.addClass("focus")}),d&&d.length&&i.on("keydown",function(e){if(13===e.which){var o=t("<option>"),a=i.find("input").val();i.find("input").val(""),o.attr("value",a),o.text(a),n.append(o)}}),n.on("DOMNodeInserted",function(o){var n=t(o.target);n.val().length&&(e._addOption(r,n),r.find("li").not(".dropdownjs-add").attr("tabindex",0))}),n.on("change",function(o){var d=t(o.target);if(d.val().length)if(a)e._select(s,n.find(":selected"));else{var i;i=n.find(":selected").length?n.find(":selected").last():n.find("option, li").first(),e._select(s,i)}}),l.on("click focus",function(e){if(e.stopPropagation(),!n.is(":disabled")){t(".dropdownjs > ul > li").attr("tabindex",-1),t(".dropdownjs > input").not(t(this)).removeClass("focus").blur(),t(".dropdownjs > ul > li").not(".dropdownjs-add").attr("tabindex",0);var o={top:t(this).offset().top-t(document).scrollTop(),left:t(this).offset().left-t(document).scrollLeft(),bottom:t(window).height()-(t(this).offset().top-t(document).scrollTop()),right:t(window).width()-(t(this).offset().left-t(document).scrollLeft())},a=o.bottom;200>a&&o.top>o.bottom?(a=o.top,r.attr("placement","top-left")):r.attr("placement","bottom-left"),t(this).next("ul").css("max-height",a-20),t(this).addClass("focus")}}),t(document).on("click",function(e){a&&t(e.target).parents(".dropdownjs").length||t(e.target).parents(".dropdownjs-add").length||t(e.target).is(".dropdownjs-add")||(t(".dropdownjs > ul > li").attr("tabindex",-1),l.removeClass("focus"))})}}o=o?t.extend(e.options,o):e.options,o.autoinit&&t(document).on("DOMNodeInserted",function(e){var a=t(e.target);a.is("select")||(a=a.find("select")),a.is(o.autoinit)&&a.each(function(){n(t(this))})}),t(this).each(function(){n(t(this))})},select:function(o){var n=t(this).find('[value="'+o+'"]');e._select(t(this),n)},_select:function(e,o){if(!o.is(".dropdownjs-add")){var n=e.data("select"),a=e.find("input.fakeinput"),d=n.attr("multiple"),i=e.find("li");if(d){o.toggleClass("selected"),o.each(function(){var e=n.find('[value="'+t(this).attr("value")+'"]');e.prop("selected",t(this).hasClass("selected"))});var s=[];i.each(function(){t(this).hasClass("selected")&&s.push(t(this).text())}),a.val(s.join(", "))}d||(o.is("li")&&i.not(o).removeClass("selected"),o.addClass("selected"),n.val(o.attr("value")),a.val(o.text().trim())),t.material&&(a.val().trim()?n.removeClass("empty"):n.addClass("empty")),this.options.onSelected&&this.options.onSelected(o.attr("value"))}},_addOption:function(e,o){var n=t("<li></li>");n.addClass(this.options.optionClass),o.text()?n.text(o.text()):n.html("&nbsp;"),n.attr("value",o.val()),e.data("select").attr("data-dynamic-opts")&&(n.append("<span class=close></span>"),n.find(".close").on("click",function(){n.remove(),o.remove()})),o.prop("selected")&&(n.attr("selected",!0),n.addClass("selected")),e.find(".dropdownjs-add").length?e.find(".dropdownjs-add").before(n):e.append(n)}};t.fn.dropdown=function(o){return e[o]?e[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"==typeof o|!o?e.init.apply(this,arguments):void t.error("Method "+o+" does not exists on jQuery.dropdown")}});